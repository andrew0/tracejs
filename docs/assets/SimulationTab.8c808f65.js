import{_ as t}from"./SimulationToolbar.68a87b21.js";import{S as e,C as a,N as r,_ as s,a as o}from"./ModelInputChart.34d802fc.js";import{d as n,c as i,g as l,o as c,a as h,k as d,b as u,e as m,A as p}from"./index.98a10f1d.js";import{C as x,g}from"./BaseChart.565d3a44.js";var y=n({components:{SimulationChart:e},setup(){const t=l();return{store:t,numXTicks:a.length*r,numYTicks:r,chartData:i((()=>{var e;return(null==(e=t.sim.value)?void 0:e.featLayer[t.currentCycle.value])||[]})),yLabelCallback:(t,e)=>e<a.length?a[e]:null}}});y.render=function(t,e,a,r,s,o){const n=d("SimulationChart");return c(),h(n,{"chart-data":t.chartData,"chart-title":"Feature Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Feature Continua","y-label-callback":t.yLabelCallback,"num-x-ticks":t.store.config.fSlices+1,"num-y-ticks":t.numXTicks,"y-step-size":t.numYTicks,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","y-step-size","sim-config"])};var f=n({components:{SimulationChart:e},setup(){const t=l(),e=i((()=>{var e;const a=((null==(e=t.sim.value)?void 0:e.wordLayer[t.currentCycle.value])||[]).map(((e,a)=>[t.config.lexicon.length>a?t.config.lexicon[a].phon:"",e]));return a.sort(((t,e)=>Math.max(...e[1])-Math.max(...t[1]))),a.slice(0,10)})),a=i((()=>e.value.map((([t,e])=>t)))),r=i((()=>e.value.map((([t,e])=>e))));return{store:t,chartData:r,yLabelCallback:(e,r)=>r<a.value.length?a.value[r]:r<t.config.lexicon.length?t.config.lexicon[r].phon:null}}});f.render=function(t,e,a,r,s,o){const n=d("SimulationChart");return c(),h(n,{"chart-data":t.chartData,"chart-title":"Word Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Word","y-label-callback":t.yLabelCallback,"num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"num-y-ticks":10,"y-step-size":1,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","sim-config"])},x.controllers.box=x.DatasetController.extend({dataElementType:x.elements.Rectangle,update(t){const e=this.getMeta(),a=e.data||[];this._xScale=this.getScaleForId(e.xAxisID),this._yScale=this.getScaleForId(e.yAxisID);for(const[r,s]of a.entries())this.updateElement(s,r,t)},updateElement(t,e,a){const r=this.getDataset(),s=this.index,o=r.data[e],n=this._xScale,i=this._yScale,l=this._resolveElementOptions(t,e),c=a?n.getBasePixel():n.getPixelForValue(o,e,s),h=a?i.getBasePixel():i.getPixelForValue(o,e,s),d=l.height,u=l.width,m=d/2;t._xScale=n,t._yScale=i,t._options=l,t._datasetIndex=s,t._index=e,t._model={xCenter:c,x:c,base:h-m,y:h+m,width:u,height:d,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderSkipped:l.borderSkipped,borderWidth:l.borderWidth,word:o.word},t.pivot()},draw(){const t=this.getMeta().data||[],e=this.chart.ctx;for(const a of t){const{word:t,xCenter:r,y:s,height:o,borderColor:n}=a._model,i=10;e.save(),e.textBaseline="middle",e.textAlign="center",e.font='bold 16px "Helvetica Neue", Helvetica, Arial, sans-serif',e.fillStyle=n,a._model.width=e.measureText(t).width+2*i,a._model.x=r+a._model.width/2-i,e.fillText(t,a._model.x,s-o/2),e.restore(),a.draw()}},_resolveElementOptions(t,e){const a=this.chart,r=a.data.datasets[this.index],s=a.options.elements.rectangle,o={},n={chart:a,dataIndex:e,dataset:r,datasetIndex:this.index},i=["backgroundColor","borderColor","borderSkipped","borderWidth","width","height"];for(const l of i)o[l]=x.helpers.options.resolve([r[l],s[l]],n,e);return o}}),x.defaults.box={hover:{mode:"nearest",intersect:!0},tooltips:{mode:"nearest",intersect:!0},scales:{xAxes:[{type:"linear"}],yAxes:[{type:"linear"}]},elements:{rectangle:{borderSkipped:!1,width:20,height:20}}};const b=["black","red","orange","green","blue","magenta","darkgray","darkgray","darkgray","darkgray"];var v=n({extends:g("box-chart","box"),props:{chartData:Array,chartTitle:String,xAxisTitle:String,yAxisTitle:String,numXTicks:Number,simConfig:Object,borderWidth:{type:Number,default:1}},data(){return{options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,legend:{display:!1},tooltips:{enabled:!1},title:{display:!0,text:this.chartTitle},scales:{xAxes:[{ticks:{display:!0,min:0,max:this.numXTicks-1,stepSize:1},gridLines:{display:!1},scaleLabel:{display:!0,labelString:this.xAxisTitle}}],yAxes:[{ticks:{display:!0,min:0,max:1,stepSize:.1},gridLines:{display:!0},scaleLabel:{display:!0,labelString:this.yAxisTitle}}]}}}},watch:{chartData(){this.updateChart()}},mounted(){this.updateChart()},methods:{updateChart(){const t=this.chartData.slice().sort(((t,e)=>e.y-t.y)),e=[];for(const{word:s}of t)e.includes(s)||e.push(s);const a={};for(const[s,o]of e.entries())a[o]=b[Math.min(s,b.length-1)];const r={datasets:[{label:"My Matrix",data:this.chartData,backgroundColor:()=>"transparent",borderColor:t=>t.dataset.data[t.dataIndex]?a[t.dataset.data[t.dataIndex].word]:"transparent",borderWidth:()=>this.borderWidth,width:t=>{const{right:e,left:a}=t.chart.chartArea;return(e-a)/this.options.scales.xAxes[0].ticks.max*5},height:t=>{const{bottom:e,top:a}=t.chart.chartArea;return(e-a)/this.options.scales.yAxes[0].ticks.max/10}}]};this.renderChart(r,this.options)}}}),C=n({components:{BoxChart:v},setup(){const t=l();return{store:t,chartData:i((()=>{var e;const a=(null==(e=t.sim.value)?void 0:e.wordLayer[t.currentCycle.value])||[],{min:r,max:s}=t.config,o=.01*(s-r),n=a.map(((e,a)=>[t.config.lexicon.length>a?t.config.lexicon[a].phon:"",e]));n.sort(((t,e)=>Math.max(...e[1])-Math.max(...t[1])));const i=n.slice(0,10),l=[];for(const[t,c]of i){let e=Number.NEGATIVE_INFINITY;for(let a=0;a<c.length;a++){const n=c[a],i=a+1<c.length?c[a+1]:Number.NEGATIVE_INFINITY;if(n>e&&n>i&&n>o){const e=(n-r)/(s-r);l.push({x:a,y:e,word:t})}e=n}}return l}))}}});C.render=function(t,e,a,r,s,o){const n=d("BoxChart");return c(),h(n,{"chart-data":t.chartData,"chart-title":"Word Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Activation Magnitude","num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"sim-config":t.store.config},null,8,["chart-data","num-x-ticks","sim-config"])};var k=n({components:{SimulationChart:e},setup(){const t=l();return{store:t,chartData:i((()=>{var e;return(null==(e=t.sim.value)?void 0:e.phonLayer[t.currentCycle.value])||[]})),yLabelCallback:(e,a)=>a<t.sortedPhonemes.value.length?t.sortedPhonemes.value[a].label:null}}});k.render=function(t,e,a,r,s,o){const n=d("SimulationChart");return c(),h(n,{"chart-data":t.chartData,"chart-title":"Phoneme Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Phoneme","y-label-callback":t.yLabelCallback,"num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"num-y-ticks":t.store.config.phonology.length,"y-step-size":1,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","sim-config"])};var _=n({components:{BoxChart:v},setup(){const t=l();return{store:t,chartData:i((()=>{var e;const a=(null==(e=t.sim.value)?void 0:e.phonLayer[t.currentCycle.value])||[],{min:r,max:s}=t.config,o=.02*(s-r),n=[];for(const[i,l]of a.entries())for(let e=0;e<l.length-1;e++){const a=l[e];if(a>l[e+1]&&a>o){const o=(a-r)/(s-r);n.push({x:e,y:o,word:t.sortedPhonemes.value.length>i?t.sortedPhonemes.value[i].label:"?"})}}return n}))}}});_.render=function(t,e,a,r,s,o){const n=d("BoxChart");return c(),h(n,{"chart-data":t.chartData,"chart-title":"Phoneme Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Activation Magnitude","num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"sim-config":t.store.config,"border-width":0},null,8,["chart-data","num-x-ticks","sim-config"])};var A=n({name:"SimulationTab",components:{ConfigInput:s,SimulationToolbar:t,FeatureActivationsChart:y,WordActivationsChart:f,WordBoxChart:C,ModelInputChart:o,PhonemeActivationsChart:k,PhonemeBoxChart:_},setup(){const t=l();return{useBoxChart:t.useBoxChart,config:t.config}}});var S={container:"_container_1jqsk_2",toolbar:"_toolbar_1jqsk_8",main:"_main_1jqsk_14",grid:"_grid_1jqsk_21","chart-wrapper":"_chart-wrapper_1jqsk_28","input-wrapper":"_input-wrapper_1jqsk_36"};(A.__cssModules={}).$style=S,A.render=function(t,e,a,r,s,o){const n=d("SimulationToolbar"),i=d("ConfigInput"),l=d("FeatureActivationsChart"),x=d("WordActivationsChart"),g=d("WordBoxChart"),y=d("ModelInputChart"),f=d("PhonemeActivationsChart"),b=d("PhonemeBoxChart");return c(),h("div",{class:t.$style.container},[u("div",{class:t.$style.toolbar},[u(n,{"show-cycles":"","show-chart-options":""})],2),u("div",{class:t.$style["input-wrapper"]},[u(i,{modelValue:t.config.modelInput,"onUpdate:modelValue":e[1]||(e[1]=e=>t.config.modelInput=e),label:"Model Input",note:"",type:"text"},null,8,["modelValue"])],2),u("div",{class:t.$style.main},[u("div",{class:t.$style.grid},[u(l,{class:t.$style["chart-wrapper"]},null,8,["class"]),m(u(x,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[p,!t.useBoxChart]]),m(u(g,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[p,t.useBoxChart]]),u(y,{class:t.$style["chart-wrapper"]},null,8,["class"]),m(u(f,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[p,!t.useBoxChart]]),m(u(b,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[p,t.useBoxChart]])],2)],2)],2)};export default A;
