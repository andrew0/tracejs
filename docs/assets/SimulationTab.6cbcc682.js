import{_ as t}from"./SimulationToolbar.da487e40.js";import{S as e,C as a,N as r,_ as s}from"./ModelInputChart.bb31fef4.js";import{d as o,b as i,g as n,o as l,c,r as h,a as d,w as u,u as m}from"./index.fea91626.js";import{C as x,g as p}from"./BaseChart.de79a112.js";var g=o({components:{SimulationChart:e},setup(){const t=n();return{store:t,numXTicks:a.length*r,numYTicks:r,chartData:i((()=>{var e;return(null==(e=t.sim.value)?void 0:e.featLayer[t.currentCycle.value])||[]})),yLabelCallback:(t,e)=>e<a.length?a[e]:null}}});g.render=function(t,e,a,r,s,o){const i=h("SimulationChart");return l(),c(i,{"chart-data":t.chartData,"chart-title":"Feature Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Feature Continua","y-label-callback":t.yLabelCallback,"num-x-ticks":t.store.config.fSlices+1,"num-y-ticks":t.numXTicks,"y-step-size":t.numYTicks,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","y-step-size","sim-config"])};var y=o({components:{SimulationChart:e},setup(){const t=n(),e=i((()=>{var e;const a=((null==(e=t.sim.value)?void 0:e.wordLayer[t.currentCycle.value])||[]).map(((e,a)=>[t.config.lexicon.length>a?t.config.lexicon[a].phon:"",e]));return a.sort(((t,e)=>Math.max(...e[1])-Math.max(...t[1]))),a.slice(0,10)})),a=i((()=>e.value.map((([t,e])=>t)))),r=i((()=>e.value.map((([t,e])=>e))));return{store:t,chartData:r,yLabelCallback:(e,r)=>r<a.value.length?a.value[r]:r<t.config.lexicon.length?t.config.lexicon[r].phon:null}}});y.render=function(t,e,a,r,s,o){const i=h("SimulationChart");return l(),c(i,{"chart-data":t.chartData,"chart-title":"Word Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Word","y-label-callback":t.yLabelCallback,"num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"num-y-ticks":10,"y-step-size":1,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","sim-config"])},x.controllers.box=x.DatasetController.extend({dataElementType:x.elements.Rectangle,update(t){const e=this.getMeta(),a=e.data||[];this._xScale=this.getScaleForId(e.xAxisID),this._yScale=this.getScaleForId(e.yAxisID);for(const[r,s]of a.entries())this.updateElement(s,r,t)},updateElement(t,e,a){const r=this.getDataset(),s=this.index,o=r.data[e],i=this._xScale,n=this._yScale,l=this._resolveElementOptions(t,e),c=a?i.getBasePixel():i.getPixelForValue(o,e,s),h=a?n.getBasePixel():n.getPixelForValue(o,e,s),d=l.height,u=l.width,m=d/2;t._xScale=i,t._yScale=n,t._options=l,t._datasetIndex=s,t._index=e,t._model={xCenter:c,x:c,base:h-m,y:h+m,width:u,height:d,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderSkipped:l.borderSkipped,borderWidth:l.borderWidth,word:o.word},t.pivot()},draw(){const t=this.getMeta().data||[],e=this.chart.ctx;for(const a of t){const{word:t,xCenter:r,y:s,height:o,borderColor:i}=a._model,n=10;e.save(),e.textBaseline="middle",e.textAlign="center",e.font='bold 16px "Helvetica Neue", Helvetica, Arial, sans-serif',e.fillStyle=i,a._model.width=e.measureText(t).width+2*n,a._model.x=r+a._model.width/2-n,e.fillText(t,a._model.x,s-o/2),e.restore(),a.draw()}},_resolveElementOptions(t,e){const a=this.chart,r=a.data.datasets[this.index],s=a.options.elements.rectangle,o={},i={chart:a,dataIndex:e,dataset:r,datasetIndex:this.index},n=["backgroundColor","borderColor","borderSkipped","borderWidth","width","height"];for(const l of n)o[l]=x.helpers.options.resolve([r[l],s[l]],i,e);return o}}),x.defaults.box={hover:{mode:"nearest",intersect:!0},tooltips:{mode:"nearest",intersect:!0},scales:{xAxes:[{type:"linear"}],yAxes:[{type:"linear"}]},elements:{rectangle:{borderSkipped:!1,width:20,height:20}}};const f=["black","red","orange","green","blue","magenta","darkgray","darkgray","darkgray","darkgray"];var b=o({extends:p("box-chart","box"),props:{chartData:Array,chartTitle:String,xAxisTitle:String,yAxisTitle:String,numXTicks:Number,simConfig:Object,borderWidth:{type:Number,default:1}},data(){return{options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,legend:{display:!1},tooltips:{enabled:!1},title:{display:!0,text:this.chartTitle},scales:{xAxes:[{ticks:{display:!0,min:0,max:this.numXTicks-1,stepSize:1},gridLines:{display:!1},scaleLabel:{display:!0,labelString:this.xAxisTitle}}],yAxes:[{ticks:{display:!0,min:0,max:1,stepSize:.1},gridLines:{display:!0},scaleLabel:{display:!0,labelString:this.yAxisTitle}}]}}}},watch:{chartData(){this.updateChart()}},mounted(){this.updateChart()},methods:{updateChart(){const t=this.chartData.slice().sort(((t,e)=>e.y-t.y)),e=[];for(const{word:s}of t)e.includes(s)||e.push(s);const a={};for(const[s,o]of e.entries())a[o]=f[Math.min(s,f.length-1)];const r={datasets:[{label:"My Matrix",data:this.chartData,backgroundColor:()=>"transparent",borderColor:t=>t.dataset.data[t.dataIndex]?a[t.dataset.data[t.dataIndex].word]:"transparent",borderWidth:()=>this.borderWidth,width:t=>{const{right:e,left:a}=t.chart.chartArea;return(e-a)/this.options.scales.xAxes[0].ticks.max*5},height:t=>{const{bottom:e,top:a}=t.chart.chartArea;return(e-a)/this.options.scales.yAxes[0].ticks.max/10}}]};this.renderChart(r,this.options)}}}),v=o({components:{BoxChart:b},setup(){const t=n();return{store:t,chartData:i((()=>{var e;const a=(null==(e=t.sim.value)?void 0:e.wordLayer[t.currentCycle.value])||[],{min:r,max:s}=t.config,o=.01*(s-r),i=a.map(((e,a)=>[t.config.lexicon.length>a?t.config.lexicon[a].phon:"",e]));i.sort(((t,e)=>Math.max(...e[1])-Math.max(...t[1])));const n=i.slice(0,10),l=[];for(const[t,c]of n){let e=Number.NEGATIVE_INFINITY;for(let a=0;a<c.length;a++){const i=c[a],n=a+1<c.length?c[a+1]:Number.NEGATIVE_INFINITY;if(i>e&&i>n&&i>o){const e=(i-r)/(s-r);l.push({x:a,y:e,word:t})}e=i}}return l}))}}});v.render=function(t,e,a,r,s,o){const i=h("BoxChart");return l(),c(i,{"chart-data":t.chartData,"chart-title":"Word Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Activation Magnitude","num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"sim-config":t.store.config},null,8,["chart-data","num-x-ticks","sim-config"])};var C=o({components:{SimulationChart:e},setup(){const t=n();return{store:t,chartData:i((()=>{var e;return(null==(e=t.sim.value)?void 0:e.phonLayer[t.currentCycle.value])||[]})),yLabelCallback:(e,a)=>a<t.sortedPhonemes.value.length?t.sortedPhonemes.value[a].label:null}}});C.render=function(t,e,a,r,s,o){const i=h("SimulationChart");return l(),c(i,{"chart-data":t.chartData,"chart-title":"Phoneme Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Phoneme","y-label-callback":t.yLabelCallback,"num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"num-y-ticks":t.store.config.phonology.length,"y-step-size":1,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","sim-config"])};var k=o({components:{BoxChart:b},setup(){const t=n();return{store:t,chartData:i((()=>{var e;const a=(null==(e=t.sim.value)?void 0:e.phonLayer[t.currentCycle.value])||[],{min:r,max:s}=t.config,o=.02*(s-r),i=[];for(const[n,l]of a.entries())for(let e=0;e<l.length-1;e++){const a=l[e];if(a>l[e+1]&&a>o){const o=(a-r)/(s-r);i.push({x:e,y:o,word:t.sortedPhonemes.value.length>n?t.sortedPhonemes.value[n].label:"?"})}}return i}))}}});k.render=function(t,e,a,r,s,o){const i=h("BoxChart");return l(),c(i,{"chart-data":t.chartData,"chart-title":"Phoneme Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Activation Magnitude","num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"sim-config":t.store.config,"border-width":0},null,8,["chart-data","num-x-ticks","sim-config"])};var w=o({name:"SimulationTab",components:{SimulationToolbar:t,FeatureActivationsChart:g,WordActivationsChart:y,WordBoxChart:v,ModelInputChart:s,PhonemeActivationsChart:C,PhonemeBoxChart:k},setup:()=>({useBoxChart:n().useBoxChart})});var A={container:"_container_1wcw8_2",toolbar:"_toolbar_1wcw8_8",main:"_main_1wcw8_14",grid:"_grid_1wcw8_21","chart-wrapper":"_chart-wrapper_1wcw8_28"};(w.__cssModules={}).$style=A,w.render=function(t,e,a,r,s,o){const i=h("SimulationToolbar"),n=h("FeatureActivationsChart"),x=h("WordActivationsChart"),p=h("WordBoxChart"),g=h("ModelInputChart"),y=h("PhonemeActivationsChart"),f=h("PhonemeBoxChart");return l(),c("div",{class:t.$style.container},[d("div",{class:t.$style.toolbar},[d(i,{"show-cycles":"","show-chart-options":""})],2),d("div",{class:t.$style.main},[d("div",{class:t.$style.grid},[d(n,{class:t.$style["chart-wrapper"]},null,8,["class"]),u(d(x,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[m,!t.useBoxChart]]),u(d(p,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[m,t.useBoxChart]]),d(g,{class:t.$style["chart-wrapper"]},null,8,["class"]),u(d(y,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[m,!t.useBoxChart]]),u(d(f,{class:t.$style["chart-wrapper"]},null,8,["class"]),[[m,t.useBoxChart]])],2)],2)],2)};export default w;
