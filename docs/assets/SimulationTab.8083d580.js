import{d as y,e as b,l as d,o as C,k as _,c as L,a as w,j as g,n as p,x as S,H as $}from"./vendor.b7f06019.js";import{S as W}from"./SimulationToolbar.b78e1c16.js";import{S as T,C as j,M as E}from"./ModelInputChart.72597b89.js";import{C as D,N as I}from"./FileSaver.min.0a96e38f.js";import{_ as x,g as v}from"./index.7d6a1ba5.js";import{C as k,g as F}from"./BaseChart.81a2306a.js";const V=y({components:{SimulationChart:T},setup(){const t=v();return{store:t,numXTicks:D.length*I,numYTicks:I,chartData:b(()=>{var e;return((e=t.sim.value)==null?void 0:e.featLayer[t.currentCycle.value])||[]}),yLabelCallback(e,a){return a<D.length?D[a]:null}}}});function z(t,e,a,i,o,s){const n=d("SimulationChart");return C(),_(n,{"chart-data":t.chartData,"chart-title":"Feature Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Feature Continua","y-label-callback":t.yLabelCallback,"num-x-ticks":t.store.config.fSlices+1,"num-y-ticks":t.numXTicks,"y-step-size":t.numYTicks,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","y-step-size","sim-config"])}var q=x(V,[["render",z]]);const H=y({components:{SimulationChart:T},setup(){const t=v(),e=b(()=>{var n;const s=(((n=t.sim.value)==null?void 0:n.wordLayer[t.currentCycle.value])||[]).map((c,r)=>[t.config.lexicon.length>r?t.config.lexicon[r].phon:"",c]);return s.sort((c,r)=>Math.max(...r[1])-Math.max(...c[1])),s.slice(0,10)}),a=b(()=>e.value.map(([o,s])=>o)),i=b(()=>e.value.map(([o,s])=>s));return{store:t,chartData:i,yLabelCallback(o,s){return s<a.value.length?a.value[s]:s<t.config.lexicon.length?t.config.lexicon[s].phon:null}}}});function O(t,e,a,i,o,s){const n=d("SimulationChart");return C(),_(n,{"chart-data":t.chartData,"chart-title":"Word Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Word","y-label-callback":t.yLabelCallback,"num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"num-y-ticks":10,"y-step-size":1,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","sim-config"])}var U=x(H,[["render",O]]);k.controllers.box=k.DatasetController.extend({dataElementType:k.elements.Rectangle,update(t){const e=this.getMeta(),a=e.data||[];this._xScale=this.getScaleForId(e.xAxisID),this._yScale=this.getScaleForId(e.yAxisID);for(const[i,o]of a.entries())this.updateElement(o,i,t)},updateElement(t,e,a){const i=this.getDataset(),o=this.index,s=i.data[e],n=this._xScale,c=this._yScale,r=this._resolveElementOptions(t,e),l=a?n.getBasePixel():n.getPixelForValue(s,e,o),h=a?c.getBasePixel():c.getPixelForValue(s,e,o),f=r.height,u=r.width,m=f/2;t._xScale=n,t._yScale=c,t._options=r,t._datasetIndex=o,t._index=e,t._model={xCenter:l,x:l,base:h-m,y:h+m,width:u,height:f,backgroundColor:r.backgroundColor,borderColor:r.borderColor,borderSkipped:r.borderSkipped,borderWidth:r.borderWidth,word:s.word},t.pivot()},draw(){const t=this.getMeta().data||[],e=this.chart.ctx;for(const a of t){const{word:i,xCenter:o,y:s,height:n,borderColor:c}=a._model,r=10;e.save(),e.textBaseline="middle",e.textAlign="center",e.font='bold 16px "Helvetica Neue", Helvetica, Arial, sans-serif',e.fillStyle=c,a._model.width=e.measureText(i).width+r*2,a._model.x=o+a._model.width/2-r,e.fillText(i,a._model.x,s-n/2),e.restore(),a.draw()}},_resolveElementOptions(t,e){const a=this.chart,o=a.data.datasets[this.index],s=a.options.elements.rectangle,n={},c={chart:a,dataIndex:e,dataset:o,datasetIndex:this.index},r=["backgroundColor","borderColor","borderSkipped","borderWidth","width","height"];for(const l of r)n[l]=k.helpers.options.resolve([o[l],s[l]],c,e);return n}});k.defaults.box={hover:{mode:"nearest",intersect:!0},tooltips:{mode:"nearest",intersect:!0},scales:{xAxes:[{type:"linear"}],yAxes:[{type:"linear"}]},elements:{rectangle:{borderSkipped:!1,width:20,height:20}}};const P=["black","red","orange","green","blue","magenta","darkgray","darkgray","darkgray","darkgray"];var B=y({extends:F("box-chart","box"),props:{chartData:Array,chartTitle:String,xAxisTitle:String,yAxisTitle:String,numXTicks:Number,simConfig:Object,borderWidth:{type:Number,default:1}},data(){return{options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,legend:{display:!1},tooltips:{enabled:!1},title:{display:!0,text:this.chartTitle},scales:{xAxes:[{ticks:{display:!0,min:0,max:this.numXTicks-1,stepSize:1},gridLines:{display:!1},scaleLabel:{display:!0,labelString:this.xAxisTitle}}],yAxes:[{ticks:{display:!0,min:0,max:1,stepSize:.1},gridLines:{display:!0},scaleLabel:{display:!0,labelString:this.yAxisTitle}}]}}}},watch:{chartData(){this.updateChart()}},mounted(){this.updateChart()},methods:{updateChart(){const t=this.chartData.slice().sort((o,s)=>s.y-o.y),e=[];for(const{word:o}of t)e.includes(o)||e.push(o);const a={};for(const[o,s]of e.entries())a[s]=P[Math.min(o,P.length-1)];const i={datasets:[{label:"My Matrix",data:this.chartData,backgroundColor:()=>"transparent",borderColor:o=>o.dataset.data[o.dataIndex]?a[o.dataset.data[o.dataIndex].word]:"transparent",borderWidth:()=>this.borderWidth,width:o=>{const{right:s,left:n}=o.chart.chartArea;return(s-n)/this.options.scales.xAxes[0].ticks.max*5},height:o=>{const{bottom:s,top:n}=o.chart.chartArea;return(s-n)/this.options.scales.yAxes[0].ticks.max/10}}]};this.renderChart(i,this.options)}}});const X=y({components:{BoxChart:B},setup(){const t=v();return{store:t,chartData:b(()=>{var r;const e=((r=t.sim.value)==null?void 0:r.wordLayer[t.currentCycle.value])||[],{min:a,max:i}=t.config,o=(i-a)*.01,s=e.map((l,h)=>[t.config.lexicon.length>h?t.config.lexicon[h].phon:"",l]);s.sort((l,h)=>Math.max(...h[1])-Math.max(...l[1]));const n=s.slice(0,10),c=[];for(const[l,h]of n){let f=Number.NEGATIVE_INFINITY;for(let u=0;u<h.length;u++){const m=h[u],A=u+1<h.length?h[u+1]:Number.NEGATIVE_INFINITY;if(m>f&&m>A&&m>o){const N=(m-a)/(i-a);c.push({x:u,y:N,word:l})}f=m}}return c})}}});function Y(t,e,a,i,o,s){const n=d("BoxChart");return C(),_(n,{"chart-data":t.chartData,"chart-title":"Word Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Activation Magnitude","num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"sim-config":t.store.config},null,8,["chart-data","num-x-ticks","sim-config"])}var R=x(X,[["render",Y]]);const G=y({components:{SimulationChart:T},setup(){const t=v();return{store:t,chartData:b(()=>{var e;return((e=t.sim.value)==null?void 0:e.phonLayer[t.currentCycle.value])||[]}),yLabelCallback(e,a){return a<t.sortedPhonemes.value.length?t.sortedPhonemes.value[a].label:null}}}});function J(t,e,a,i,o,s){const n=d("SimulationChart");return C(),_(n,{"chart-data":t.chartData,"chart-title":"Phoneme Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Phoneme","y-label-callback":t.yLabelCallback,"num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"num-y-ticks":t.store.config.phonology.length,"y-step-size":1,"sim-config":t.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","sim-config"])}var K=x(G,[["render",J]]);const Q=y({components:{BoxChart:B},setup(){const t=v();return{store:t,chartData:b(()=>{var n;const e=((n=t.sim.value)==null?void 0:n.phonLayer[t.currentCycle.value])||[],{min:a,max:i}=t.config,o=(i-a)*.02,s=[];for(const[c,r]of e.entries())for(let l=0;l<r.length-1;l++){const h=r[l],f=r[l+1];if(h>f&&h>o){const u=(h-a)/(i-a);s.push({x:l,y:u,word:t.sortedPhonemes.value.length>c?t.sortedPhonemes.value[c].label:"?"})}}return s})}}});function Z(t,e,a,i,o,s){const n=d("BoxChart");return C(),_(n,{"chart-data":t.chartData,"chart-title":"Phoneme Activations","x-axis-title":"Temporal Alignment","y-axis-title":"Activation Magnitude","num-x-ticks":Math.ceil(t.store.config.fSlices/t.store.config.slicesPerPhon)+1,"sim-config":t.store.config,"border-width":0},null,8,["chart-data","num-x-ticks","sim-config"])}var tt=x(Q,[["render",Z]]);const et="_container_1jqsk_2",at="_toolbar_1jqsk_8",ot="_main_1jqsk_14",st="_grid_1jqsk_21";var nt={container:et,toolbar:at,main:ot,grid:st,"chart-wrapper":"_chart-wrapper_1jqsk_28","input-wrapper":"_input-wrapper_1jqsk_36"};const rt=y({name:"SimulationTab",components:{ConfigInput:j,SimulationToolbar:W,FeatureActivationsChart:q,WordActivationsChart:U,WordBoxChart:R,ModelInputChart:E,PhonemeActivationsChart:K,PhonemeBoxChart:tt},setup(){const t=v();return{useBoxChart:t.useBoxChart,config:t.config}}});function it(t,e,a,i,o,s){const n=d("SimulationToolbar"),c=d("ConfigInput"),r=d("FeatureActivationsChart"),l=d("WordActivationsChart"),h=d("WordBoxChart"),f=d("ModelInputChart"),u=d("PhonemeActivationsChart"),m=d("PhonemeBoxChart");return C(),L("div",{class:p(t.$style.container)},[w("div",{class:p(t.$style.toolbar)},[g(n,{"show-cycles":"","show-chart-options":""})],2),w("div",{class:p(t.$style["input-wrapper"])},[g(c,{modelValue:t.config.modelInput,"onUpdate:modelValue":e[0]||(e[0]=A=>t.config.modelInput=A),label:"Model Input",note:"",type:"text"},null,8,["modelValue"])],2),w("div",{class:p(t.$style.main)},[w("div",{class:p(t.$style.grid)},[g(r,{class:p(t.$style["chart-wrapper"])},null,8,["class"]),S(g(l,{class:p(t.$style["chart-wrapper"])},null,8,["class"]),[[$,!t.useBoxChart]]),S(g(h,{class:p(t.$style["chart-wrapper"])},null,8,["class"]),[[$,t.useBoxChart]]),g(f,{class:p(t.$style["chart-wrapper"])},null,8,["class"]),S(g(u,{class:p(t.$style["chart-wrapper"])},null,8,["class"]),[[$,!t.useBoxChart]]),S(g(m,{class:p(t.$style["chart-wrapper"])},null,8,["class"]),[[$,t.useBoxChart]])],2)],2)],2)}const M={};M.$style=nt;var mt=x(rt,[["render",it],["__cssModules",M]]);export{mt as default};
