import{_ as S,g as _,T as A}from"./index.1d8391d4.js";import{C as y,N as k}from"./constants.7d013e07.js";import{C as h,g as V}from"./BaseChart.93217dd5.js";import{d as b,q as I,z as w,o as g,x as N,c as f,a as c,t as v,D as C,B as D}from"./vendor.b9e80e26.js";var $=h.helpers.options.resolve;h.controllers.matrix=h.DatasetController.extend({dataElementType:h.elements.Rectangle,update:function(e){var a=this,t=a.getMeta(),s=t.data||[],r,i;for(a._xScale=a.getScaleForId(t.xAxisID),a._yScale=a.getScaleForId(t.yAxisID),r=0,i=s.length;r<i;++r)a.updateElement(s[r],r,e)},updateElement:function(e,a,t){var s=this,r=s.getDataset(),i=s.index,l=r.data[a],d=s._xScale,n=s._yScale,o=s._resolveElementOptions(e,a),u=t?d.getBasePixel():d.getPixelForValue(l,a,i),m=t?n.getBasePixel():n.getPixelForValue(l,a,i),p=o.height,T=o.width,x=p/2;e._xScale=d,e._yScale=n,e._options=o,e._datasetIndex=i,e._index=a,e._model={x:u,base:m-x,y:m+x,width:T,height:p,backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth},e.pivot()},draw:function(){var e=this,a=e.getMeta().data||[],t,s;for(t=0,s=a.length;t<s;++t)a[t].draw()},_resolveElementOptions:function(e,a){var t=this,s=t.chart,r=s.data.datasets,i=r[t.index],l=s.options.elements.rectangle,d={},n,o,u,m={chart:s,dataIndex:a,dataset:i,datasetIndex:t.index},p=["backgroundColor","borderColor","borderSkipped","borderWidth","width","height"];for(n=0,o=p.length;n<o;++n)u=p[n],d[u]=$([i[u],l[u]],m,a);return d}});h.defaults.matrix={hover:{mode:"nearest",intersect:!0},tooltips:{mode:"nearest",intersect:!0},scales:{xAxes:[{type:"linear"}],yAxes:[{type:"linear"}]},elements:{rectangle:{borderSkipped:!1,width:20,height:20}}};var M=b({extends:V("matrix-chart","matrix"),props:{chartData:Array,chartTitle:String,xAxisTitle:String,yAxisTitle:String,yLabelCallback:Function,numXTicks:Number,numYTicks:Number,yStepSize:Number,simConfig:Object},data(){return{options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},legend:{display:!1},tooltips:{enabled:!1},title:{display:!0,text:this.chartTitle},scales:{xAxes:[{ticks:{display:!0,min:0,max:this.numXTicks-1,stepSize:1},gridLines:{display:!1},scaleLabel:{display:!0,labelString:this.xAxisTitle}}],yAxes:[{ticks:{display:!0,min:0,max:this.numYTicks,stepSize:this.yStepSize||1,callback:this.yLabelCallback||(e=>e),fontColor:"transparent"},gridLines:{display:!0},scaleLabel:{display:!0,labelString:this.yAxisTitle}}]}}}},watch:{chartData:function(){this.updateChart()}},mounted(){this.addPlugin({afterDraw:e=>{const a=e.ctx,t=e.scales["y-axis-0"],s=t.getPixelForTick(1)-t.getPixelForTick(0);h.helpers.each(t.ticks,function(r,i){if(i===t.ticks.length-1)return;const l=t.right,d=t.getPixelForTick(i),n=10;a.save(),a.textBaseline="middle",a.textAlign="right",a.fillStyle="rgba(0, 0, 0, 0.8)",a.fillText(r,l-n,d+s/2),a.restore()})}}),this.updateChart()},methods:{updateChart(){const e=[];for(const[t,s]of this.chartData.entries())for(const[r,i]of s.entries())i>0&&e.push({x:r+.5,y:this.numYTicks-.5-t,v:(Math.min(Math.max(i,0),1)-this.simConfig.min)/(this.simConfig.max-this.simConfig.min)});const a={datasets:[{label:"My Matrix",data:e,backgroundColor:t=>{const s=t.dataset.data[t.dataIndex];return`rgba(0, 0, 0, ${s?s.v:0})`},width:t=>{const{right:s,left:r}=t.chart.chartArea;return(s-r)/this.options.scales.xAxes[0].ticks.max},height:t=>{const{bottom:s,top:r}=t.chart.chartArea;return(s-r)/this.options.scales.yAxes[0].ticks.max}}]};this.renderChart(a,this.options)}}});const P=b({components:{SimulationChart:M},setup(){const e=_();return{store:e,numXTicks:y.length*k,numYTicks:k,chartData:I(()=>{try{return e.isModelInputValid.value=!0,new A(e.config).inputLayer||[]}catch{return e.isModelInputValid.value=!1,[]}}),yLabelCallback(a,t){return t<y.length?y[t]:null}}}});function F(e,a,t,s,r,i){const l=w("SimulationChart");return g(),N(l,{"chart-data":e.chartData,"chart-title":"Model Input","x-axis-title":"Time","y-axis-title":"Feature Continua","y-label-callback":e.yLabelCallback,"num-x-ticks":e.store.config.fSlices+1,"num-y-ticks":e.numXTicks,"y-step-size":e.numYTicks,"sim-config":e.store.config},null,8,["chart-data","y-label-callback","num-x-ticks","num-y-ticks","y-step-size","sim-config"])}var K=S(P,[["render",F]]);const E=b({name:"ConfigInput",props:{modelValue:{type:[String,Number],default:""},lastValue:{type:[String,Number],default:null},label:{type:String,default:""},note:{type:String,default:""},error:{type:String,default:""},type:{type:String,default:"number"}},emits:["update:modelValue"],setup(e,{emit:a}){return{onChange:t=>{const s=e.type==="number"?Number(t.target.value):t.target.value;a("update:modelValue",s)}}}}),L={class:"field is-horizontal",style:{width:"30rem"}},z={class:"field-label"},B={class:"label",style:{width:"10rem"}},R={class:"field-body"},O={class:"field"},Y=["type","value"],X={class:"help is-info"},U={key:0,class:"help is-danger"},W=c("span",{class:"has-text-weight-bold"},"ERROR",-1);function j(e,a,t,s,r,i){return g(),f("div",L,[c("div",z,[c("label",B,v(e.label),1),e.lastValue!=null&&e.lastValue!==e.modelValue?(g(),f("button",{key:0,class:"button is-small",onClick:a[0]||(a[0]=l=>e.$emit("update:modelValue",e.lastValue))}," Reset ")):C("",!0)]),c("div",R,[c("div",O,[c("input",{class:"input",type:e.type,value:e.modelValue,onChange:a[1]||(a[1]=(...l)=>e.onChange&&e.onChange(...l))},null,40,Y),c("p",X,v(e.note),1),e.error?(g(),f("p",U,[W,D(" "+v(e.error),1)])):C("",!0)])])])}var Q=S(E,[["render",j]]);export{Q as C,K as M,M as S};
